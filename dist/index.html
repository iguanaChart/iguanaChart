<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <!-- Remove Tap Highlight on Windows Phone IE -->
  <meta name="msapplication-tap-highlight" content="no"/>

  <title>Iguana Charts</title>

  <script type="text/javascript" src="/i18n/i18n.ru.js"></script>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/uikit/2.26.4/css/uikit.css" media="all">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/qtip2/2.2.1/basic/jquery.qtip.min.css" media="all">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-minicolors/2.3.5/jquery.minicolors.min.css" media="all">

  <link rel="stylesheet" href="/iguanachart.css" media="all">

  <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
</head>
<body>
<button class="js-show-chart-indicators">Show Indicators</button>
<div class="iChart" style="position: relative"></div>

<script src="/iguanachart.js"></script>
<script type="text/javascript">
(function() {
  iChartDataSource.host = "https://tradernet.ru";

  var dataSource = $.extend(true, {}, iChartDataSource);
  dataSource.dataSettings.strategies = window.localStorage.getItem('userStrategiesAndIndicators');
  dataSource.dataSettings.graphicIndicators = window.localStorage.getItem('userSettingsGraphicIndicators');

  $('.iChart').on("iguanaChartEvents", function(e, name, data){
    // console.log("iguanaChartEvents", name, data);

    switch (name) {
      case "saveIndicatorsAndStrategies":
        const encoded = JSON.stringify(data);
        window.localStorage.setItem('userStrategiesAndIndicators', encoded);
        break;
    }

  }).iguanaChart({
    // ticker: "AAPL.US",
    ticker: "TSLA.US",
    period: "1M",
    // lib_path: "./",
    chartOptions: {
      minHeight: 600,
      showVolume: 'inside',
      uiTools: {top: true},
    },
    dataSource: dataSource,
  });

  document.querySelector('.js-show-chart-indicators').addEventListener('click', function () {
    $('.iChart').data('iguanaChart').showIndicators({ forAll: true });
  });
})();
</script>
</body>
</html>
